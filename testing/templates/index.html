<!DOCTYPE html>
<html>
<head>
    <title>Real-Time Status Updates</title>
    <style>
        .inactive {
            color: lightgray;
            display: none; /* Initially hide the elements */
        }
        .active {
            font-weight: bold;
            display: block; /* Show elements when they are active */
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>
<body>
    <h1>Process Status</h1>
    <div id="status">
        <p id="extracting" class="inactive">Extracting data...</p>
        <p id="analyzing" class="inactive">Analyzing data...</p>
        <p id="separating" class="inactive">Separating PDF...</p>
    </div>
    <button onclick="startProcess()">Start Process</button>

    <script type="text/javascript">
        var socket = io.connect('http://' + document.domain + ':' + location.port);

        socket.on('connect', function() {
            console.log('Connected to server');
        });

        socket.on('status_update', function(data) {
            console.log('Received status update:', data);
            
            // Update the status message and ensure it is visible
            var element = document.getElementById(data.step);
            element.innerText = data.status;
            element.style.display = 'block';

            // Reset all steps to inactive
            document.getElementById('extracting').className = 'inactive';
            document.getElementById('analyzing').className = 'inactive';
            document.getElementById('separating').className = 'inactive';

            // Set the current step to active if it is in progress
            if (data.status.endsWith('...')) {
                element.className = 'active';
            } else {
                element.className = 'inactive';
            }
        });

        function startProcess() {
            console.log('Start process clicked');
            
            // Reset the status text and class and make them visible
            var steps = ['extracting', 'analyzing', 'separating'];
            steps.forEach(function(step) {
                var element = document.getElementById(step);
                element.innerText = element.getAttribute('data-initial-text');
                element.className = 'inactive';
                element.style.display = 'block'; // Ensure elements are visible
            });

            socket.emit('start_process');
        }

        // Set initial text data attributes
        document.getElementById('extracting').setAttribute('data-initial-text', 'Extracting data...');
        document.getElementById('analyzing').setAttribute('data-initial-text', 'Analyzing data...');
        document.getElementById('separating').setAttribute('data-initial-text', 'Separating PDF...');
    </script>
</body>
</html>
