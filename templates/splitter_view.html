{% extends "base.html" %}
{% block title %}Split PDF{% endblock %}
{% block content %}
<div class="card">
    <div class="card-header">
        Split PDF
    </div>
    <div class="card-body">
        <form id="split-form">
            <div class="form-group">
                <label for="split-points">Enter split points (comma-separated):</label>
                <input type="text" class="form-control" id="split-points" placeholder="e.g., 1,3,5">
            </div>
            <button type="button" class="btn btn-primary" id="split-btn">Split PDF</button>
        </form>
        <div class="mt-4">
            <h5>PDF Pages:</h5>
            <div id="pages-list" class="d-flex flex-wrap">
                {% for image_path in image_paths %}
                <div class="m-2">
                    <img src="{{ url_for('static', filename=image_path.split('static/')[-1]) }}" class="img-thumbnail" style="max-width: 200px;">
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
<script>
    document.getElementById('split-btn').addEventListener('click', function() {
        const splitPoints = document.getElementById('split-points').value.split(',').map(Number);
        fetch("{{ url_for('split_pdf') }}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ split_points: splitPoints }),
        })
        .then(response => response.blob())
        .then(blob => {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'split_pdfs.zip';
            document.body.appendChild(a);
            a.click();
            a.remove();
        })
        .catch(error => console.error('Error splitting PDF:', error));
    });
</script>
{% endblock %}
